var E=Object.defineProperty;var _=(t,e,n)=>e in t?E(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var u=(t,e,n)=>_(t,typeof e!="symbol"?e+"":e,n);import{m as x}from"./pinia-OQ_CXEtD.js";import{T as v,_ as y,E as C,u as I,a as d,b as S}from"./index-Bk18EYnp.js";import"./sweetalert2-BQIkj5Wb.js";import{r as z,d as D,I as l,K as r,V as f,O as T,R as P,U as p,L as b,Q as L,J as g,T as w,M as N}from"./@vue-BoO0vas5.js";import"./vue-loading-overlay-BeUYO37k.js";import"./vue-router-DbEUm0xe.js";import"./axios-Dq7h7Pqt.js";import"./swiper-DifugWLp.js";import"./bootstrap-B6X7VvZS.js";import"./@popperjs-BEKk9TLb.js";import"./vee-validate-B3OKONGr.js";import"./@vee-validate-CU2VKbMu.js";import"./vue-CRovxOtr.js";const V=10,B=1;class A{constructor(e,n=V,i=B){u(this,"datas");u(this,"pageSize");u(this,"currentPage");this.datas=e,this.pageSize=n,this.currentPage=i}}function O(t){const e=t.datas;if(!(e instanceof Array))throw Error("[datas] 必須使用陣列！");let n;try{n=v.converToNumber(t.pageSize)}catch(o){throw new Error("[pageSize] 不正確！",{cause:o})}let i;try{i=z(v.converToNumber(t.currentPage))}catch(o){throw new Error("[currentPage] 不正確！",{cause:o})}const a=e.length;let c=Math.ceil(a/n);const m=D(()=>{const o=(i.value-1)*n,M=i.value*n;return e.slice(o,M)});function s(o){if(o=v.converToNumber(o),o<1||o>c)throw Error(`[pageNo] 頁碼應介於 1 ~ ${c} 之間！`);i.value=o}function h(){const o=i.value+1;o<=c&&(i.value=o)}function k(){const o=i.value-1;o>=1&&(i.value=o)}return{currentDatas:m,currentPage:i,totalPages:c,totalSize:a,pageSize:n,changePage:s,goToNextPage:h,goToPrevPage:k}}const U={data(){return{selectedTagIds:d.getTagData(),tagModel:null,eventTagModel:null,pagination:null,pageSize:12}},methods:{...x(S,{openLoading:"open",closeLoading:"close"}),toggleTag(t){const e=this.selectedTagIds.indexOf(t);e>=0?this.selectedTagIds.splice(e,1):this.selectedTagIds.push(t),d.updateTagData(this.selectedTagIds),d.updatePageData(1)}},computed:{filteredEvents(){var t,e,n,i,a,c;return((e=(t=this.eventTagModel)==null?void 0:t.datas)==null?void 0:e.length)>0?((n=this.selectedTagIds)==null?void 0:n.length)>0&&((i=this.selectedTagIds)==null?void 0:i.length)<((c=(a=this.tagModel)==null?void 0:a.datas)==null?void 0:c.length)?this.eventTagModel.filterByTagIds(this.selectedTagIds):this.eventTagModel.datas:[]}},watch:{filteredEvents(t){const e=d.getPageData(),n=new A(t,this.pageSize,e);this.pagination=O(n)},"pagination.currentPage"(t){d.updatePageData(t)},"pagination.currentDatas"(){window.scrollTo({top:0})}},components:{EventCard:C},created(){this.openLoading(),I().then(t=>{this.tagModel=t.tagModel,this.eventTagModel=t.eventTagModel,console.log("this.eventTagModel =====>",this.eventTagModel)}).finally(()=>{this.closeLoading()})}},F={class:"container mt-4 mt-md-8"},H={key:0,class:"d-flex flex-wrap gap-2 mb-8"},J=["onClick"],K={key:1,class:"row row-gap-6 row-gap-md-12 mb-8 mb-md-15"},Q={"aria-label":"Page navigation",class:"mb-12 mb-md-15"},R={key:0,class:"pagination"},j=["onClick"];function q(t,e,n,i,a,c){const m=L("EventCard");return g(),l("div",F,[e[4]||(e[4]=r("h2",{class:"title mb-3 mb-md-8"},[r("span",{class:"title-english"},"EVENT"),r("span",{class:"title-chinese"},"所有活動")],-1)),a.tagModel?(g(),l("ul",H,[(g(!0),l(T,null,P(a.tagModel.datas,s=>(g(),l("li",{key:s.id},[r("button",{type:"button",class:p(a.selectedTagIds.includes(s.id)?"tag-btn-selected":"tag-btn"),onClick:h=>c.toggleTag(s.id)},w(s.name),11,J)]))),128))])):f("",!0),a.pagination?(g(),l("ul",K,[(g(!0),l(T,null,P(a.pagination.currentDatas,s=>(g(),l("li",{class:"col-md-6 col-xl-4",key:s.id},[N(m,{event:s},null,8,["event"])]))),128))])):f("",!0),r("nav",Q,[a.pagination?(g(),l("ul",R,[r("li",{class:p(["page-item",{disabled:a.pagination.currentPage===1}])},[r("a",{class:"page-link fs-18",href:"#",onClick:e[0]||(e[0]=b((...s)=>a.pagination.goToPrevPage&&a.pagination.goToPrevPage(...s),["prevent"]))},e[2]||(e[2]=[r("i",{class:"icofont-arrow-left"},null,-1)]))],2),(g(!0),l(T,null,P(a.pagination.totalPages,s=>(g(),l("li",{key:s,class:p(["page-item",{active:a.pagination.currentPage===s}])},[r("a",{class:"page-link",href:"#",onClick:b(h=>a.pagination.changePage(s),["prevent"])},w(s),9,j)],2))),128)),r("li",{class:p(["page-item",{disabled:a.pagination.currentPage===a.pagination.totalPages}])},[r("a",{class:"page-link fs-18",href:"#",onClick:e[1]||(e[1]=b((...s)=>a.pagination.goToNextPage&&a.pagination.goToNextPage(...s),["prevent"]))},e[3]||(e[3]=[r("i",{class:"icofont-arrow-right"},null,-1)]))],2)])):f("",!0)])])}const le=y(U,[["render",q]]);export{le as default};
//# sourceMappingURL=EventListView-xCFNW7gz.js.map
